################################################################################
export TMPDIR = $(HOME)/tmp

################################################################################
TMP_DUMMY     = $(TMPDIR)/.dummy
STACK_OPTS    = --stack-yaml=build/stack.yaml

################################################################################
.PHONY: all test clean release

################################################################################
all: $(TMP_DUMMY)
	stack $(STACK_OPTS) setup
	stack $(STACK_OPTS) build
	hlint --hint data/HLint.hs src test

################################################################################
test:
	stack $(STACK_OPTS) test

################################################################################
clean:
	stack $(STACK_OPTS) clean

################################################################################
release:
	$(MAKE) clean test
	stack $(STACK_OPTS) upload .
